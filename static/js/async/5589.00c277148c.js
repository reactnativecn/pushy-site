"use strict";(self.rspackChunkpushy_site=self.rspackChunkpushy_site||[]).push([["5589"],{9469(s,n,e){e.r(n),e.d(n,{default:()=>c});var r=e(2615),i=e(416);let l=e.p+"static/image/deeplinkqrcode.e4a16cb983.jpg";var o=e(7425);function a(s){let n={a:"a",code:"code",h3:"h3",h4:"h4",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",span:"span",strong:"strong",ul:"ul",...(0,i.R)(),...s.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Pq,{type:"info",title:"Info",children:(0,r.jsxs)(n.p,{children:["\n请注意，当前版本的api经过了完全重构，与之前的版本(v10.0以下)不兼容。如果你需要查看之前版本的文档，请点击",(0,r.jsx)(n.a,{href:"https://v9--pushy-site.netlify.app/",rel:"noopener noreferrer",target:"_blank",children:"这里"})]})}),"\n",(0,r.jsxs)(n.p,{children:["首先你应该有一个基于 React Native 开发的应用，我们把具有 package.json 的目录叫做你的",(0,r.jsx)(n.code,{children:"应用根目录"}),"。\n如果你还没有初始化应用，请参阅",(0,r.jsx)(n.a,{href:"https://reactnative.cn/docs/getting-started",rel:"noopener noreferrer",target:"_blank",children:"开始使用 React Native"}),"。"]}),"\n",(0,r.jsxs)(n.p,{children:["我们假设你已经拥有了开发 React Native 应用的一切环境，包括",(0,r.jsx)(n.code,{children:"Node.js"}),"、",(0,r.jsx)(n.code,{children:"Xcode"}),"、",(0,r.jsx)(n.code,{children:"Android SDK"}),"等等。"]}),"\n",(0,r.jsxs)(o.gj,{children:[(0,r.jsxs)(n.h3,{id:"安装",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#安装",children:"#"}),"安装"]}),(0,r.jsx)(n.p,{children:"在你的项目根目录下运行以下命令（如果你使用 yarn 等其他包管理器，请自行替换命令）："}),(0,r.jsxs)(o.tU,{children:[(0,r.jsx)(o.oz,{label:"React Native",children:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"bash",children:(0,r.jsxs)(n.code,{children:[(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"# 先全局安装命令行工具"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"npm"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" i"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" -g"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" react-native-update-cli"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"# 然后在项目目录中安装热更新模块"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"npm"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" i"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" react-native-update"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"# 如果没有使用 expo，则进入 iOS 目录安装 iOS 模块"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"cd"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" ios"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:" &&"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" pod"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" install"})]}),"\n",(0,r.jsx)(n.span,{className:"line"})]})})})}),(0,r.jsxs)(o.oz,{label:"Expo",children:[(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"bash",children:(0,r.jsxs)(n.code,{children:[(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"# 先全局安装命令行工具"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"npm"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" i"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" -g"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" react-native-update-cli"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"# 然后在项目目录中安装热更新模块"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"npm"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" i"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" react-native-update"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"# 如果使用 expo, 要求 expo 50 或更高版本，需要使用 prebuild 命令预构建项目"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"npx"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" expo"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" prebuild"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"# 然后进入 iOS 目录安装 iOS 模块"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"cd"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" ios"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:" &&"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" pod"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" install"})]}),"\n",(0,r.jsx)(n.span,{className:"line"})]})})}),(0,r.jsx)(o.Pq,{type:"warning",title:"Warning",children:(0,r.jsxs)(n.p,{children:["\n注意：如果使用\nexpo，请不要同时安装",(0,r.jsx)(n.code,{children:"expo-updates"}),"，否则会导致热更新功能冲突。另外，expo 51\n版本以下的新架构支持并不完整，可能无法正常使用。如需使用新架构，建议使用尽可能新的\nexpo 版本。"]})})]})]}),(0,r.jsx)(o.Pq,{type:"info",title:"Info",children:(0,r.jsxs)(n.p,{children:["\n如果下载极慢或者显示网络失败，请设置使用淘宝镜像 ",(0,r.jsx)(n.code,{children:"npx nrm use taobao"})]})}),(0,r.jsx)(o.Pq,{type:"warning",title:"Warning",children:(0,r.jsxs)(n.p,{children:["\n注意请不要混用",(0,r.jsx)(n.code,{children:"npm/yarn/pnpm"}),"等包管理器及对应的",(0,r.jsx)(n.code,{children:"lock"}),"文件，团队成员请坚持使用同一包管理器，且仅保留统一格式的",(0,r.jsx)(n.code,{children:"lock"}),"文件"]})}),(0,r.jsx)(o.Pq,{type:"info",title:"Info",children:(0,r.jsx)(n.p,{children:"\n请记得，任意在 ios 和 android 目录下的修改，一定要重新编译（使用 npx\nreact-native run-ios 或 run-android 命令编译，或在 Xcode/Android Studio\n中重新编译）才能生效。"})}),(0,r.jsxs)(n.h3,{id:"手动-link",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#手动-link",children:"#"}),"手动 link"]}),(0,r.jsx)(n.p,{children:"如果 RN 版本 >= 0.60 则不需要此手动 link 步骤。"}),(0,r.jsx)(o.Pq,{type:"warning",title:"Warning",children:(0,r.jsx)(n.p,{children:"\n注意：如果是混编 RN\n项目，或monorepo，或任何其他自定义的情况，由于自定义的配置可能不完整或不适应RN的目录结构，导致自动\nlink 的功能可能不能正常工作。此时即便 RN 版本 >= 0.60，你可能也需要执行手动\nlink 操作。"})}),(0,r.jsxs)(n.h4,{id:"ios",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#ios",children:"#"}),"iOS"]}),(0,r.jsxs)("details",{children:[(0,r.jsx)("summary",{children:"RN < 0.60且使用CocoaPods（推荐）"}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"在 ios/Podfile 中添加"}),"\n"]}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"txt",children:(0,r.jsx)(n.code,{children:(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{children:"pod 'react-native-update', path: '../node_modules/react-native-update'"})})})})}),(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:["在项目的 ios 目录下运行",(0,r.jsx)(n.code,{children:"pod install"})]}),"\n",(0,r.jsx)(n.li,{children:"重新编译"}),"\n"]})]}),(0,r.jsxs)("details",{children:[(0,r.jsx)("summary",{children:"RN < 0.60且不使用CocoaPods"}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["在 XCode 中的 Project Navigator 里,右键点击",(0,r.jsx)(n.code,{children:"Libraries"})," ➜ ",(0,r.jsx)(n.code,{children:"Add Files to [你的工程名]"})]}),"\n",(0,r.jsxs)(n.li,{children:["进入",(0,r.jsx)(n.code,{children:"node_modules"})," ➜ ",(0,r.jsx)(n.code,{children:"react-native-update"})," ➜ ",(0,r.jsx)(n.code,{children:"ios 并选中"}),"RCTPushy.xcodeproj`"]}),"\n",(0,r.jsxs)(n.li,{children:["在 XCode 中的 project navigator 里,选中你的工程,在 ",(0,r.jsx)(n.code,{children:"Build Phases"})," ➜ ",(0,r.jsx)(n.code,{children:"Link Binary With Libraries"})," 中添加 ",(0,r.jsx)(n.code,{children:"libRCTPushy.a"}),"、",(0,r.jsx)(n.code,{children:"libz.tbd"}),"、",(0,r.jsx)(n.code,{children:"libbz2.1.0.tbd"})]}),"\n",(0,r.jsxs)(n.li,{children:["继续在",(0,r.jsx)(n.code,{children:"Build Settings"}),"里搜索",(0,r.jsx)(n.code,{children:"Header Search Path"}),"，添加",(0,r.jsx)(n.code,{children:"$(SRCROOT)/../node_modules/react-native-update/ios"}),"，勾选",(0,r.jsx)(n.code,{children:"recursive"}),"。"]}),"\n",(0,r.jsxs)(n.li,{children:["在",(0,r.jsx)(n.code,{children:"Build Phases"}),"添加一个",(0,r.jsx)(n.code,{children:"New Run Script Phase"}),"运行脚本，内容如下"]}),"\n"]}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"txt",children:(0,r.jsxs)(n.code,{children:[(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{children:"#!/bin/bash"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{children:"set -x"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{children:'DEST="../node_modules/react-native-update/ios/"'})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{children:'date +%s > "$DEST/pushy_build_time.txt"'})})]})})}),(0,r.jsxs)(n.ol,{start:"7",children:["\n",(0,r.jsxs)(n.li,{children:["尝试编译一下，顺利的话就会在",(0,r.jsx)(n.code,{children:"../node_modules/react-native-update/ios/"}),"文件夹下面生成一个",(0,r.jsx)(n.code,{children:"pushy_build_time.txt"}),"文件。然后在",(0,r.jsx)(n.code,{children:"Copy Bundle Resources"}),"里把生成的",(0,r.jsx)(n.code,{children:"pushy_build_time.txt"}),"文件添加进去。"]}),"\n"]})]}),(0,r.jsxs)(n.h4,{id:"android",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#android",children:"#"}),"Android"]}),(0,r.jsxs)("details",{children:[(0,r.jsx)("summary",{children:"RN < 0.60 或其他不能自动 link 的情况"}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["在",(0,r.jsx)(n.code,{children:"android/settings.gradle"}),"中添加如下代码:"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"txt",children:(0,r.jsxs)(n.code,{children:[(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{children:"include ':react-native-update'"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{children:"project(':react-native-update').projectDir = new File(rootProject.projectDir, 	'../node_modules/react-native-update/android')"})})]})})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["在",(0,r.jsx)(n.code,{children:"android/app/build.gradle"}),"的 dependencies 部分增加如下代码:"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"txt",children:(0,r.jsx)(n.code,{children:(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{children:"implementation project(':react-native-update')"})})})})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["打开",(0,r.jsx)(n.code,{children:"android/app/src/main/java/[...]/MainApplication.java"}),","]}),"\n"]}),"\n"]}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["在文件开头增加 ",(0,r.jsx)(n.code,{children:"import cn.reactnative.modules.update.UpdatePackage;"})]}),"\n",(0,r.jsxs)(n.li,{children:["在",(0,r.jsx)(n.code,{children:"getPackages()"})," 方法中增加 ",(0,r.jsx)(n.code,{children:"new UpdatePackage()"}),"(注意上一行可能要增加一个逗号)"]}),"\n"]})]}),(0,r.jsxs)(n.h3,{id:"配置-bundle-url",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#配置-bundle-url",children:"#"}),"配置 Bundle URL"]}),(0,r.jsxs)(n.p,{children:["如果你使用 ",(0,r.jsx)(n.code,{children:"expo"})," 48 或更高版本，且 ",(0,r.jsx)(n.code,{children:"react-native-update"})," >= 10.28.2，则可以自动配置 bundle url，请直接去往",(0,r.jsx)(n.a,{href:"#%E6%B7%BB%E5%8A%A0%E6%B5%8B%E8%AF%95%E7%94%A8%E7%9A%84-deep-link",children:"下一个步骤"}),"。\n如果你没有使用 ",(0,r.jsx)(n.code,{children:"expo"}),"，或 ",(0,r.jsx)(n.code,{children:"expo"})," 版本低于 48，则需要按以下步骤手动配置。"]}),(0,r.jsxs)(n.h4,{id:"ios-1",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#ios-1",children:"#"}),"iOS"]}),(0,r.jsx)(n.p,{children:"在你的 AppDelegate.mm 或 AppDelegate.m 或 AppDelegate.swift 文件（不同 RN 版本可能后缀名不同）中增加如下代码："}),(0,r.jsx)(o.Pq,{type:"warning",title:"Warning",children:(0,r.jsxs)(n.p,{children:["\n注意：如果你是混编原生的项目，务必注意",(0,r.jsx)(n.strong,{children:"不能直接指定 bundleURL 来初始化"}),"\nrootView，需要先使用",(0,r.jsx)(n.code,{children:"initWithDelegate"}),"方法来初始化\nbridge，然后使用",(0,r.jsx)(n.code,{children:"initWithBridge"}),"方法来初始化\nrootView。否则热更新功能可能无法正常工作。"]})}),(0,r.jsxs)(o.tU,{children:[(0,r.jsx)(o.oz,{label:"Objective-C",children:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"c",children:(0,r.jsxs)(n.code,{children:[(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// ... 其它代码"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"#import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "AppDelegate.h"'})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"#import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "RCTPushy.h"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"  // <-- import头文件，注意要放到if条件外面"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 可能项目里有一些条件编译语句，例如有些版本RN自带的flipper"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// #if DEBUG"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:'// 注意**不要**在这里面引入"RCTPushy.h"'})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// #import <FlipperKit/FlipperClient.h>"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// #endif"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// rn 版本 >= 0.74 需要修改 bundleURL 方法"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" (NSURL "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:")bundleURL"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"{"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"#if"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" DEBUG"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"  // 原先DEBUG这里的写法不作修改"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"  return"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" [[RCTBundleURLProvider sharedSettings] jsBundleURLForBundleRoot:@"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"index"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"];"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"#else"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"  return"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" [RCTPushy bundleURL];"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"  // <--  把这里非DEBUG的情况替换为热更新bundle"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"#endif"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"}"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// rn 版本 < 0.74 需要修改sourceURLForBridge方法"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" (NSURL "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:")sourceURLForBridge:(RCTBridge "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:")bridge"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"{"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"#if"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" DEBUG"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"  // 原先DEBUG这里的写法不作修改"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"  return"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" [[RCTBundleURLProvider sharedSettings] jsBundleURLForBundleRoot:@"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"index"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"];"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"#else"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"  return"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" [RCTPushy bundleURL];"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"  // <--  把这里非DEBUG的情况替换为热更新bundle"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"#endif"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"}"})}),"\n",(0,r.jsx)(n.span,{className:"line"})]})})})}),(0,r.jsx)(o.oz,{label:"Swift",children:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"swift",children:(0,r.jsxs)(n.code,{children:[(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" UIKit"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" React"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" React_RCTAppDelegate"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" ReactAppDependencyProvider"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" react_native_update"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    // <-- 在这里引入，需要 pushy v10.22.0+ 版本"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"@main"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" AppDelegate"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" RCTAppDelegate "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"{"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"  // ... 其他代码"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"  override"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" func"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" bundleURL"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"() "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" URL"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"?"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"#"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" DEBUG"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    // 原先 DEBUG 这里的写法不作修改(所以 DEBUG 模式下不可热更新)"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    RCTBundleURLProvider."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"sharedSettings"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"jsBundleURL"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"forBundleRoot"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "index"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"#"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"else"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    RCTPushy."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"bundleURL"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"  // <--  把这里非 DEBUG 的情况替换为热更新 bundle"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"#"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"endif"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  }"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})})})]}),(0,r.jsxs)(n.h4,{id:"android-1",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#android-1",children:"#"}),"Android"]}),(0,r.jsxs)(n.p,{children:["在 MainApplication 中增加如下代码（如果是混编原生的项目或其他原因没有使用 ReactApplication，请",(0,r.jsx)(n.a,{href:"/docs/api.html#updatecontextsetcustominstancemanagerreactinstancemanager-instancemanager",children:"使用此 api 集成"}),")："]}),(0,r.jsxs)(o.tU,{children:[(0,r.jsx)(o.oz,{label:"Kotlin（RN 0.82 或以上）",children:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"kotlin",children:(0,r.jsxs)(n.code,{children:[(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// ... 其它代码"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// ↓↓↓请注意不要少了这句import"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" cn.reactnative.modules.update.UpdateContext"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// ↑↑↑"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" MainApplication"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" : "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"Application"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(), "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"ReactApplication"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"  override"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" val"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" reactHost: "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"ReactHost"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" by"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" lazy"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"    getDefaultReactHost"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"      context "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" applicationContext,"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"      packageList "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"        PackageList"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"this"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:").packages."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"apply"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"          // Packages that cannot be auto-linked yet can be added manually here, for example:"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"          // add(MyReactNativePackage())"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"        },"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"      // ↓↓↓ 添加下面这一段参数"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"      jsBundleFilePath "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" UpdateContext."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"getBundleUrl"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"this"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"),"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"      // ↑↑↑"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    )"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  }"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"  // ...其他代码"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"}"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line"})]})})})}),(0,r.jsx)(o.oz,{label:"Kotlin（RN 0.81 或以下）",children:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"kotlin",children:(0,r.jsxs)(n.code,{children:[(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// ... 其它代码"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// ↓↓↓请注意不要少了这句import"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" cn.reactnative.modules.update.UpdateContext"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// ↑↑↑"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" MainApplication"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" : "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"Application"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(), "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"ReactApplication"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"  override"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" val"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" reactNativeHost: "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"ReactNativeHost"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"      object"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" : "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"DefaultReactNativeHost"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"this"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:") {"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"        // ↓↓↓将下面这一段添加到 DefaultReactNativeHost 内部！"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"        override"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" fun"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" getJSBundleFile"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(): "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"String"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"? {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"          return"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" UpdateContext."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"getBundleUrl"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"this@MainApplication"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"        }"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"        // ↑↑↑"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"        // ...其他代码"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"      }"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})})}),(0,r.jsx)(o.oz,{label:"Java",children:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"java",children:(0,r.jsxs)(n.code,{children:[(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// ... 其它代码"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// ↓↓↓请注意不要少了这句import"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" cn"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"reactnative"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"modules"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"update"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"UpdateContext"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// ↑↑↑"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"public"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" class"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" MainApplication"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" extends"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" Application"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" implements"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" ReactApplication"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"  private"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" final"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ReactNativeHost"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" mReactNativeHost "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    // 老版本 RN 这里可能是 new ReactNativeHost(this)"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"    new"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" DefaultReactNativeHost("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"this"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:")"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    // ↓↓↓将下面这一段添加到 DefaultReactNativeHost 内部！"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    @"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"Override"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"    protected"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" String"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" getJSBundleFile"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"() {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"        return"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" UpdateContext"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"getBundleUrl"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"MainApplication"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"this"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:");"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    }"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    // ↑↑↑"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    // ...其他代码"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  }"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})})})]}),(0,r.jsx)(o.Pq,{type:"info",title:"Info",children:(0,r.jsx)(n.p,{children:"\n请记得，任意在 ios 和 android 目录下的修改，一定要重新编译（npx react-native\nrun-ios 或 run-android 命令编译，或在 Xcode/Android Studio\n中重新编译）才能生效。"})}),(0,r.jsxs)(n.h4,{id:"harmony",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#harmony",children:"#"}),"Harmony"]}),(0,r.jsxs)(n.p,{children:["在 ",(0,r.jsx)(n.code,{children:"harmony/entry/src/main/cpp/CMakeLists.txt"})," 中增加如下依赖："]}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"c",children:(0,r.jsxs)(n.code,{children:[(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"add_subdirectory"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"${OH_MODULES}/pushy/src/main/cpp"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" ."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"/"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"pushy)"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"target_link_libraries"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(rnoh_app PUBLIC rnoh_pushy)"})]})]})})}),(0,r.jsxs)(n.p,{children:["在 ",(0,r.jsx)(n.code,{children:"harmony/entry/src/main/cpp/PackageProvider.cpp"})," 中增加如下依赖："]}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"c",children:(0,r.jsxs)(n.code,{children:[(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"#include"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "RNOH/PackageProvider.h"'})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"#include"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "PushyPackage.h"'})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"using namespace rnoh;"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"std::vector"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"std::shared_ptr"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"Package"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:">>"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" PackageProvider::"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"getPackages"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(Package::Context ctx) {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"    return"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"         std::make_shared"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"PushyPackage"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:">"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(ctx)"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    };"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})}),(0,r.jsxs)(n.p,{children:["在 ",(0,r.jsx)(n.code,{children:"harmony/entry/oh-package.json5"})," 中增加如下依赖："]}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"json5",children:(0,r.jsxs)(n.code,{children:[(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"dependencies"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:": {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'  "pushy"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "file:../../node_modules/react-native-update/harmony/pushy"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})}),(0,r.jsxs)(n.p,{children:["在 ",(0,r.jsx)(n.code,{children:"harmony/build-profile.json5"})," 中增加如下配置："]}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"json5",children:(0,r.jsxs)(n.code,{children:[(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  modules: ["})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    // ↓↓↓将下面这一段添加到 modules 内部！"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    {"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"      name"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'pushy'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"      srcPath"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" '../node_modules/react-native-update/harmony/pushy'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    }"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  ],"})})]})})}),(0,r.jsxs)(n.p,{children:["在 ",(0,r.jsx)(n.code,{children:"harmony/hvigor/hvigor-config.json5"})," 中增加如下配置："]}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"json5",children:(0,r.jsxs)(n.code,{children:[(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"{"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"  dependencies"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"    pushy"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "file:../../node_modules/react-native-update/harmony/pushy"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  }"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})}),(0,r.jsxs)(n.p,{children:["在 ",(0,r.jsx)(n.code,{children:"harmony/entry/hvigorfile.ts"})," 中增加如下配置："]}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsxs)(n.code,{children:[(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { hapTasks } "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "@ohos/hvigor-ohos-plugin"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { reactNativeUpdatePlugin } "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "pushy/hvigor-plugin"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" default"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  system"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" hapTasks "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"/* Built-in plugin of Hvigor. It cannot be modified. */"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  plugins"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" ["})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"    reactNativeUpdatePlugin"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"()"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  ] "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"/* Custom plugin to extend the functionality of Hvigor. */"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"};"})})]})})}),(0,r.jsxs)(n.p,{children:["在 ",(0,r.jsx)(n.code,{children:"harmony/entry/src/main/ets/RNPackagesFactory.ts"})," 代码如下："]}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsxs)(n.code,{children:[(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" type"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  RNPackageContext"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  RNPackage"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"} "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "@rnoh/react-native-openharmony/ts"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { PushyPackage } "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "pushy/ts"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" function"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" createRNPackages"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(ctx"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" RNPackageContext"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:")"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" RNPackage"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"[] {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"  return"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" ["}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" PushyPackage"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(ctx)];"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})}),(0,r.jsxs)(n.p,{children:["在 ",(0,r.jsx)(n.code,{children:"harmony/entry/src/main/ets/pages/Index.ets"})," 中增加如下代码："]}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsxs)(n.code,{children:[(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// ... 其它代码"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// ↓↓↓请注意不要少了这句import"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { PushyFileJSBundleProvider } "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'pushy/src/main/ets/PushyFileJSBundleProvider'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// ↑↑↑"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"@Entry"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"@Component"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"struct Index {"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  @"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"StorageLink"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'RNOHCoreContext'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:") private rnohCoreContext"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" RNOHCoreContext "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" undefined"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" undefined"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  @State shouldShow"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" boolean "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" false"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"  aboutToAppear"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(): "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"void"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"    this"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:".shouldShow "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" true"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  }"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"  onBackPress"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(): boolean "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" undefined"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    // NOTE: this is required since `Ability`'s `onBackPressed` function always"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    // terminates or puts the app in the background, but we want Ark to ignore it completely"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    // when handled by RN"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"    this"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:".rnohCoreContext"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"!"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".dispatchBackPress"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"()"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    // this.preferences = preferences.getPreferencesSync(this.context, {name:'update'});"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"    return"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" true"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  }"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"  build"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"() {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"    Column"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"() {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"      if"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" ("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"this"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:".rnohCoreContext "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"&&"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" this"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:".shouldShow) {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"        RNApp"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"({"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"          // ... 其他代码"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"          jsBundleProvider"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" new"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" TraceJSBundleProviderDecorator"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"            new"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" AnyJSBundleProvider"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(["})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"              // MetroJSBundleProvider.fromServerIp('127.0.0.1'),"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"              // new ResourceJSBundleProvider(rnohCoreContext.uiAbilityContext.resourceManager, 'hermes_bundle.hbc'),"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"              // ↓↓↓将下面这一段添加到 AnyJSBundleProvider 内部！"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"              new"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" PushyFileJSBundleProvider"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"this"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"rnohCoreContext"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:".uiAbilityContext)"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"              // 注意无论是否使用 hermes 格式，请保持 bundle 文件名为 bundle.harmony.js"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"              new"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" ResourceJSBundleProvider"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"this"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"rnohCoreContext"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"uiAbilityContext"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:".resourceManager"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'bundle.harmony.js'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"            ])"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"            this"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"rnohCoreContext"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:".logger)"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"        })"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"      }"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    }"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"    .height"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'100%'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"    .width"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'100%'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  }"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})}),(0,r.jsx)(o.Pq,{type:"info",title:"Info",children:(0,r.jsx)(n.p,{children:"\n请记得，任意在 ios 和 android 目录下的修改，一定要重新编译（npx react-native\nrun-ios 或 run-android 命令编译，或在 Xcode/Android Studio\n中重新编译）才能生效。"})}),(0,r.jsxs)(n.h3,{id:"覆盖-android-的-oncreate",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#覆盖-android-的-oncreate",children:"#"}),"覆盖 android 的 onCreate"]}),(0,r.jsxs)(n.p,{children:["如果你有安装 ",(0,r.jsx)(n.code,{children:"react-native-screens"})," (使用 ",(0,r.jsx)(n.code,{children:"react-navigation"})," 一般都会要求安装)，则安卓端在热更后重启可能会白屏。此时需要在 Android 的 ",(0,r.jsx)(n.code,{children:"MainActivity"})," 中设置 ",(0,r.jsx)(n.code,{children:"RNScreensFragmentFactory"}),"，以确保 Fragment 恢复流程一致，避免崩溃。注意不要把这段覆盖写在 ",(0,r.jsx)(n.code,{children:"MainActivityDelegate"})," 里，而是直接放在 ",(0,r.jsx)(n.code,{children:"MainActivity"})," 中。\n更多说明可以参考 ",(0,r.jsx)(n.code,{children:"react-native-screens"})," 的 ",(0,r.jsx)(n.a,{href:"https://github.com/software-mansion/react-native-screens?tab=readme-ov-file#android",rel:"noopener noreferrer",target:"_blank",children:"readme"})]}),(0,r.jsxs)(o.tU,{children:[(0,r.jsx)(o.oz,{label:"Kotlin",children:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"kotlin",children:(0,r.jsxs)(n.code,{children:[(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// android/app/src/main/java/[...]/MainActivity.kt"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" android.os.Bundle"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" com.swmansion.rnscreens.fragment.restoration.RNScreensFragmentFactory"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" MainActivity"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" : "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"ReactActivity"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"() {"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"  // ...其他代码"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"  override"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" fun"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" onCreate"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(savedInstanceState: "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"Bundle"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"?) {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    supportFragmentManager.fragmentFactory "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" RNScreensFragmentFactory"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"()"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"    super"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"onCreate"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(savedInstanceState)"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    // 如果你用的版本比较老，没有 RNScreensFragmentFactory，则使用下面的写法"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    // super.onCreate(null)"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  }"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})})}),(0,r.jsx)(o.oz,{label:"Java",children:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"java",children:(0,r.jsxs)(n.code,{children:[(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// android/app/src/main/java/[...]/MainActivity.java"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" android"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"os"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"Bundle"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" com"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"swmansion"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"rnscreens"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"fragment"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"restoration"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"RNScreensFragmentFactory"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"public"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" class"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" MainActivity"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" extends"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" ReactActivity"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"  // ...其他代码"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  @"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"Override"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"  protected"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" void"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" onCreate"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"Bundle"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" savedInstanceState) {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"    getSupportFragmentManager()"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"setFragmentFactory"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" RNScreensFragmentFactory()"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:");"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    super"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"onCreate"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(savedInstanceState);"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    // 如果你用的版本比较老，没有 RNScreensFragmentFactory，则使用下面的写法"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    // super.onCreate(null);"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  }"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})})})]}),(0,r.jsxs)(n.h3,{id:"添加测试用的-deep-link",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#添加测试用的-deep-link",children:"#"}),"添加测试用的 Deep Link"]}),(0,r.jsx)(n.p,{children:"此步骤可以极其便利的在和用户完全一致的环境中安全地测试热更新，无需额外的设备注册步骤，也不影响现有的热更新流程。"}),(0,r.jsxs)(o.tU,{children:[(0,r.jsxs)(o.oz,{label:"Android",children:[(0,r.jsxs)(n.p,{children:["在 ",(0,r.jsx)(n.code,{children:"android/app/src/main/AndroidManifest.xml"})," 中添加如下代码："]}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"xml",children:(0,r.jsxs)(n.code,{children:[(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"manifest"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" xmlns"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"android"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"http://schemas.android.com/apk/res/android"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:">"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  <"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"application"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:">"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    \x3c!-- 其他代码 --\x3e"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    \x3c!-- ↓↓↓ 注意 activity 的 launchMode 需要设置为 singleTask --\x3e"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    <"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"activity"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"      android"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"launchMode"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"singleTask"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:">"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"      \x3c!-- ↑↑↑ --\x3e"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"      <"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"intent-filter"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:">"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"        <"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"action"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" android"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"name"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"android.intent.action.MAIN"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" />"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"        <"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"category"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" android"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"name"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"android.intent.category.LAUNCHER"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" />"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"      </"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"intent-filter"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:">"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"      \x3c!-- ↓↓↓ 添加如下 intent-filter， 注意和上面的 intent-filter 是不同的 action 和 category --\x3e"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"      <"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"intent-filter"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:">"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"        <"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"action"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" android"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"name"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"android.intent.action.VIEW"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" />"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"        <"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"category"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" android"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"name"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"android.intent.category.DEFAULT"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" />"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"        <"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"category"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" android"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"name"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"android.intent.category.BROWSABLE"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" />"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"        \x3c!-- 添加你自定义的 scheme --\x3e"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"        <"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"data"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" android"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"scheme"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"你自定义的协议名，请不要和常见协议名或其他app冲突"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" />"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"      </"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"intent-filter"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:">"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"      \x3c!-- ↑↑↑ --\x3e"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    </"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"activity"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:">"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  </"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"application"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:">"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"</"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"manifest"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:">"})]})]})})})]}),(0,r.jsx)(o.oz,{label:"iOS",children:(0,r.jsxs)(n.p,{children:["请参考 ",(0,r.jsx)(n.a,{href:"https://reactnative.cn/docs/next/linking#%E5%90%AF%E7%94%A8-deep-links",rel:"noopener noreferrer",target:"_blank",children:"React Native 的文档"})]})})]}),(0,r.jsx)(n.hr,{}),(0,r.jsx)(n.p,{children:"在完成上述配置并编译，并且日后上传了热更包，在后台能看到热更版本之后，你就可以将鼠标移到网页后台的二维码图标上，如下图所示："}),(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Deep Link二维码",src:l})}),(0,r.jsxs)(n.p,{children:["勾选",(0,r.jsx)(n.code,{children:"使用 Deep Link"}),"选项，在后面的输入框中填入你自定义的协议名，在二维码刷新后，即可在设备上直接使用系统相机或扫码功能（注意不能使用微信扫码）来扫描，即可自动触发热更检查功能。"]}),(0,r.jsx)(n.p,{children:"第一次扫码后可能只是触发服务器任务队列，会弹出提示 10 秒后重新扫码，此时会获得热更包，触发内置或自定义的更新策略。"}),(0,r.jsxs)(n.p,{children:["注意如果你使用自定义的更新策略，请务必从",(0,r.jsx)(n.code,{children:"useUpdate()"}),"中获取",(0,r.jsx)(n.code,{children:"updateInfo"}),"，而不要依赖",(0,r.jsx)(n.code,{children:"checkUpdate"}),"方法的返回值，否则扫码不会有后续动作。"]}),(0,r.jsxs)(n.h3,{id:"禁用-android-的-crunch-优化",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#禁用-android-的-crunch-优化",children:"#"}),"禁用 android 的 crunch 优化"]}),(0,r.jsxs)(n.p,{children:["android 会在生成 apk 时自动对 png 图片进行压缩，此操作既耗时又影响增量补丁的生成。为了保证补丁能正常生成，您需要在",(0,r.jsx)(n.code,{children:"android/app/build.gradle"}),"中关闭此操作："]}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"groovy",children:(0,r.jsxs)(n.code,{children:[(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 在 android/app/build.gradle 文件中"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"android {"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    // ..."})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    signingConfigs {"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"      // ..."})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    }"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    buildTypes {"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"        release {"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"            // ..."})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"            // 添加下面这行以禁用crunch"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"            crunchPngs "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"false"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"        }"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    }"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"}"})}),"\n",(0,r.jsx)(n.span,{className:"line"})]})})}),(0,r.jsxs)(n.h3,{id:"禁用-aab-包的资源分割如果你需要在-google-play-上架",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#禁用-aab-包的资源分割如果你需要在-google-play-上架",children:"#"}),"禁用 aab 包的资源分割（如果你需要在 Google Play 上架）"]}),(0,r.jsx)(n.p,{children:"如果你需要打 aab 包以在 Google Play 上架，且 react-native-update 版本 低于 10.36.0，则需要禁用 aab 包的资源分割。若已升级到 10.36.0+ 版本，则不需要此设置。"}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"groovy",children:(0,r.jsxs)(n.code,{children:[(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 在 android/app/build.gradle 文件中"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"android {"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    bundle {"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"        density {"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"            // 请禁用资源分割"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"            // 否则热更后可能遇到图片无法显示的问题"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"            // v10.36.0 版本之后不需要此设置"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"            enableSplit "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" false"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"        }"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    }"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"}"})}),"\n",(0,r.jsx)(n.span,{className:"line"})]})})}),(0,r.jsxs)(n.h3,{id:"登录与创建应用",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#登录与创建应用",children:"#"}),"登录与创建应用"]}),(0,r.jsxs)(n.p,{children:["首先请在 ",(0,r.jsx)(n.a,{href:"https://pushy-admin.reactnative.cn",rel:"noopener noreferrer",target:"_blank",children:"https://pushy-admin.reactnative.cn"})," 注册帐号，然后在你的项目根目录下运行以下命令："]}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"bash",children:(0,r.jsxs)(n.code,{children:[(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"$"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" pushy"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" login"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"email:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" <"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"输入你的注册邮"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"箱"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:">"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"password:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" <"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"输入你的密"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"码"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:">"})]})]})})}),(0,r.jsxs)(n.p,{children:["这会在项目文件夹下创建一个",(0,r.jsx)(n.code,{children:".update"}),"文件，注意不要把这个文件上传到 Git 等 CVS 系统上。你可以在",(0,r.jsx)(n.code,{children:".gitignore"}),"末尾增加一行",(0,r.jsx)(n.code,{children:".update"}),"来忽略这个文件。"]}),(0,r.jsx)(n.p,{children:"登录之后可以创建应用。注意 iOS 平台、安卓平台、鸿蒙平台需要分别创建："}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"bash",children:(0,r.jsxs)(n.code,{children:[(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"$"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" pushy"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" createApp"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" --platform"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" ios"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"App"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" Name:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" <"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"输入应用名"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"字"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:">"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"$"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" pushy"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" createApp"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" --platform"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" android"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"App"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" Name:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" <"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"输入应用名"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"字"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:">"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"$"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" pushy"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" createApp"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" --platform"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" harmony"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"App"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" Name:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" <"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"输入应用名"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"字"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:">"})]})]})})}),(0,r.jsx)(o.Pq,{type:"info",title:"Info",children:(0,r.jsx)(n.p,{children:"\n应用的名字可以相同，这没有关系。"})}),(0,r.jsx)(n.p,{children:"如果你已经在网页端或者其它地方创建过应用，也可以直接选择应用："}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"bash",children:(0,r.jsxs)(n.code,{children:[(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"$"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" pushy"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" selectApp"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" --platform"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" ios"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"1"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:") 鱼多多("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"ios"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"2"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:") 招财旺("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"ios"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"Total"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" 2"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" ios"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" apps"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"Enter"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" appId:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" <"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"输入应用前面的编"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"号"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:">"})]})]})})}),(0,r.jsxs)(n.p,{children:["选择或者创建过应用后，你将可以在文件夹下看到",(0,r.jsx)(n.code,{children:"update.json"}),"文件，其内容类似如下形式："]}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"bash",children:(0,r.jsxs)(n.code,{children:[(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"{"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:'    "ios"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:'        "appId"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" 1,"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:'        "appKey"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "<一串随机字符串>"'})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    },"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:'    "android"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:'        "appId"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" 2,"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:'        "appKey"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "<一串随机字符串>"'})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    },"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:'    "harmony"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:'        "appId"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:" 3,"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:'        "appKey"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "<一串随机字符串>"'})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    }"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})}),(0,r.jsxs)(n.p,{children:["你可以安全的把",(0,r.jsx)(n.code,{children:"update.json"}),"上传到 Git 等 CVS 系统上，与你的团队共享这个文件，它不包含任何敏感信息。当然，他们在使用任何功能之前，都必须首先输入",(0,r.jsx)(n.code,{children:"pushy login"}),"进行登录。"]}),(0,r.jsxs)(n.p,{children:["至此应用的创建/选择就已经成功了。下一步，你需要给代码添加相应的功能，请参阅",(0,r.jsx)(n.a,{href:"/docs/integration.html",children:"代码集成"}),"。"]})]})]})}function c(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}={...(0,i.R)(),...s.components};return n?(0,r.jsx)(n,{...s,children:(0,r.jsx)(a,{...s})}):a(s)}c.__RSPRESS_PAGE_META={},c.__RSPRESS_PAGE_META["docs%2Fgetting-started.mdx"]={toc:[],title:"安装配置",headingTitle:"",frontmatter:{order:0,title:"安装配置",type:"快速入门"}}}}]);