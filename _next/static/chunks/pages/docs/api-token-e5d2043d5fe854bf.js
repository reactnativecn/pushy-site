(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[40],{1866:function(s,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/api-token",function(){return n(58438)}])},58438:function(s,e,n){"use strict";n.r(e),n.d(e,{__toc:function(){return t}});var l=n(52676),r=n(58332),i=n(37451),o=n(6911);let t=[{depth:2,value:"使用场景",id:"使用场景"},{depth:2,value:"创建 API Token",id:"创建-api-token"},{depth:2,value:"权限说明",id:"权限说明"},{depth:2,value:"使用 Token 调用 API",id:"使用-token-调用-api"},{depth:3,value:"在命令行工具中使用",id:"在命令行工具中使用"},{depth:3,value:"在 CI/CD 中使用",id:"在-cicd-中使用"},{depth:2,value:"管理 Token",id:"管理-token"},{depth:3,value:"查看 Token 列表",id:"查看-token-列表"},{depth:3,value:"撤销 Token",id:"撤销-token"},{depth:2,value:"安全建议",id:"安全建议"},{depth:2,value:"限制",id:"限制"}];function c(s){let e=Object.assign({h1:"h1",p:"p",a:"a",h2:"h2",ul:"ul",li:"li",strong:"strong",ol:"ol",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td",pre:"pre",code:"code",span:"span",h3:"h3"},(0,i.a)(),s.components);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.h1,{children:"API Token"}),"\n",(0,l.jsxs)(e.p,{children:["API Token 是一种用于在 CI/CD 流程或自动化脚本中调用 ",(0,l.jsx)(e.a,{href:"https://update.reactnative.cn/api/openapi",children:"Pushy API"})," 的认证方式。相比直接使用账号密码，API Token 更加安全且便于管理。"]}),"\n",(0,l.jsx)(e.h2,{id:"使用场景",children:"使用场景"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"持续集成/持续部署 (CI/CD)"}),"：在 GitHub Actions、GitLab CI、Jenkins 等平台中自动发布热更新"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"自动化脚本"}),"：编写脚本批量管理应用、版本或原生包"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"第三方工具集成"}),"：将 Pushy 与其他开发工具集成"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"创建-api-token",children:"创建 API Token"}),"\n",(0,l.jsxs)(e.ol,{children:["\n",(0,l.jsxs)(e.li,{children:["登录 ",(0,l.jsx)(e.a,{href:"https://pushy-admin.reactnative.cn",children:"Pushy 管理后台"})]}),"\n",(0,l.jsx)(e.li,{children:"在左侧菜单中点击「API Token」"}),"\n",(0,l.jsx)(e.li,{children:"点击「创建 Token」按钮"}),"\n",(0,l.jsx)(e.li,{children:"填写 Token 名称（如：CI/CD Pipeline）"}),"\n",(0,l.jsx)(e.li,{children:"选择所需权限"}),"\n",(0,l.jsx)(e.li,{children:"可选设置过期时间"}),"\n",(0,l.jsxs)(e.li,{children:["点击创建后，",(0,l.jsx)(e.strong,{children:"立即复制并安全保存 Token"})]}),"\n"]}),"\n",(0,l.jsx)(o.UW,{type:"warning",children:(0,l.jsx)(e.p,{children:"Token 只会在创建时显示一次，之后无法再次查看。请务必在创建后立即复制保存！"})}),"\n",(0,l.jsx)(e.h2,{id:"权限说明",children:"权限说明"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{children:"权限"}),(0,l.jsx)(e.th,{children:"说明"})]})}),(0,l.jsxs)(e.tbody,{children:[(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:(0,l.jsx)(e.strong,{children:"读取 (read)"})}),(0,l.jsx)(e.td,{children:"查看应用、版本、原生包信息"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:(0,l.jsx)(e.strong,{children:"写入 (write)"})}),(0,l.jsx)(e.td,{children:"创建和更新应用、发布版本、上传原生包"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:(0,l.jsx)(e.strong,{children:"删除 (delete)"})}),(0,l.jsx)(e.td,{children:"删除应用、版本、原生包"})]})]})]}),"\n",(0,l.jsx)(o.UW,{type:"info",children:(0,l.jsx)(e.p,{children:"创建 Token 时至少需要选择一个权限。根据实际需求选择最小必要权限是最佳实践。"})}),"\n",(0,l.jsx)(e.h2,{id:"使用-token-调用-api",children:"使用 Token 调用 API"}),"\n",(0,l.jsx)(e.p,{children:"在调用 Pushy API 时，将 Token 添加到请求头中："}),"\n",(0,l.jsx)(e.pre,{"data-language":"bash","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"bash","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"curl"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"-X"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"GET"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"https://update.reactnative.cn/api/app/list"'}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" \\"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"-H"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"x-api-token: YOUR_API_TOKEN"'})]})]})}),"\n",(0,l.jsx)(e.h3,{id:"在命令行工具中使用",children:"在命令行工具中使用"}),"\n",(0,l.jsxs)(e.p,{children:["如果使用 ",(0,l.jsx)(e.code,{children:"react-native-update-cli"})," 命令行工具（需 v2.7.0+），可以通过环境变量设置 Token："]}),"\n",(0,l.jsx)(e.pre,{"data-language":"bash","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"bash","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" PUSHY_API_TOKEN"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"your_api_token_here"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"pushy"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"bundle"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"--platform"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"android"})]})]})}),"\n",(0,l.jsx)(e.h3,{id:"在-cicd-中使用",children:"在 CI/CD 中使用"}),"\n",(0,l.jsx)(e.p,{children:"以 GitHub Actions 为例："}),"\n",(0,l.jsx)(e.pre,{"data-language":"yaml","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"yaml","data-theme":"default",children:[(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"# .github/workflows/publish.yml"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"name"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"Publish Hot Update"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:" "}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"on"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"push"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"branches"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ["}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"main"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"]"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:" "}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"jobs"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"publish"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"runs-on"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"ubuntu-latest"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"steps"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      - "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"uses"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"actions/checkout@v4"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      "})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      - "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"name"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"Setup Node.js"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"uses"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"actions/setup-node@v4"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"with"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"          "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"node-version"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'18'"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"          "})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      - "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"name"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"Install dependencies"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"run"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"npm install && npm i -g react-native-update-cli"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      - "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"name"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"Publish update"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"env"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"          "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"PUSHY_API_TOKEN"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"${{ secrets.PUSHY_API_TOKEN }}"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"run"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"pushy bundle --platform android"})]})]})}),"\n",(0,l.jsx)(o.UW,{type:"tip",children:(0,l.jsx)(e.p,{children:"在 CI/CD 环境中，建议将 Token 存储在密钥管理中（如 GitHub Secrets），而不是直接写入代码。"})}),"\n",(0,l.jsx)(e.h2,{id:"管理-token",children:"管理 Token"}),"\n",(0,l.jsx)(e.h3,{id:"查看-token-列表",children:"查看 Token 列表"}),"\n",(0,l.jsx)(e.p,{children:"在「API Token」页面可以看到所有已创建的 Token，包括："}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"Token 名称"}),"\n",(0,l.jsx)(e.li,{children:"权限"}),"\n",(0,l.jsx)(e.li,{children:"过期时间"}),"\n",(0,l.jsx)(e.li,{children:"最后使用时间"}),"\n",(0,l.jsx)(e.li,{children:"状态（正常/已过期/已撤销）"}),"\n"]}),"\n",(0,l.jsx)(e.h3,{id:"撤销-token",children:"撤销 Token"}),"\n",(0,l.jsx)(e.p,{children:"如果 Token 泄露或不再需要，可以随时撤销："}),"\n",(0,l.jsxs)(e.ol,{children:["\n",(0,l.jsx)(e.li,{children:"在 Token 列表中找到目标 Token"}),"\n",(0,l.jsx)(e.li,{children:"点击「撤销」按钮"}),"\n",(0,l.jsx)(e.li,{children:"确认撤销"}),"\n"]}),"\n",(0,l.jsx)(o.UW,{type:"warning",children:(0,l.jsx)(e.p,{children:"Token 撤销后立即生效，使用该 Token 的所有请求将被拒绝。请确保在撤销前更新相关的 CI/CD 配置。"})}),"\n",(0,l.jsx)(e.h2,{id:"安全建议",children:"安全建议"}),"\n",(0,l.jsxs)(e.ol,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"最小权限原则"}),"：只授予 Token 必要的权限"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"设置过期时间"}),"：为临时使用的 Token 设置合理的过期时间"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"定期轮换"}),"：定期撤销旧 Token 并创建新 Token"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"安全存储"}),"：不要将 Token 提交到代码仓库，使用环境变量或密钥管理工具"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"监控使用"}),"：定期检查 Token 的最后使用时间，及时清理不再使用的 Token"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"限制",children:"限制"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["每个用户最多可创建 ",(0,l.jsx)(e.strong,{children:"10 个"})," API Token"]}),"\n",(0,l.jsx)(e.li,{children:"如需创建更多，请先撤销不再使用的 Token"}),"\n"]})]})}e.default=(0,r.j)({MDXContent:function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,i.a)(),s.components);return e?(0,l.jsx)(e,{...s,children:(0,l.jsx)(c,{...s})}):c(s)},pageOpts:{filePath:"pages/docs/api-token.mdx",route:"/docs/api-token",frontMatter:{order:12,title:"API Token",type:"开发指南"},title:"API Token",headings:t},pageNextRoute:"/docs/api-token"})}},function(s){s.O(0,[8332,2888,9774,179],function(){return s(s.s=1866)}),_N_E=s.O()}]);