(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[259],{16237:function(s,n,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/api",function(){return e(56490)}])},56490:function(s,n,e){"use strict";e.r(n),e.d(n,{__toc:function(){return o}});var r=e(11527),i=e(38567),l=e(87088);let o=[{depth:3,value:"JavaScript 方法",id:"javascript-方法"},{depth:4,value:"usePushy()",id:"usepushy"},{depth:4,value:"async function checkUpdate()",id:"async-function-checkupdate"},{depth:4,value:"async function downloadUpdate()",id:"async-function-downloadupdate"},{depth:4,value:"function downloadAndInstallApk(url)",id:"function-downloadandinstallapkurl"},{depth:4,value:"function markSuccess()",id:"function-marksuccess"},{depth:4,value:"async function getCurrentVersionInfo()",id:"async-function-getcurrentversioninfo"},{depth:4,value:"function switchVersion()",id:"function-switchversion"},{depth:4,value:"function switchVersionLater()",id:"function-switchversionlater"},{depth:4,value:"function onPushyEvents(({ type: EventType; data: EventData }) => void)",id:"function-onpushyevents-type-eventtype-data-eventdata---void"},{depth:3,value:"Android 方法",id:"android-方法"},{depth:4,value:"UpdateContext.setCustomInstanceManager(ReactInstanceManager instanceManager)",id:"updatecontextsetcustominstancemanagerreactinstancemanager-instancemanager"}];function t(s){let n=Object.assign({h3:"h3",h4:"h4",hr:"hr",p:"p",ol:"ol",li:"li",code:"code",pre:"pre",span:"span",a:"a"},(0,l.a)(),s.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h3,{id:"javascript-方法",children:"JavaScript 方法"}),"\n",(0,r.jsx)(n.h4,{id:"usepushy",children:"usePushy()"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"async-function-checkupdate",children:"async function checkUpdate()"}),"\n",(0,r.jsx)(n.p,{children:"检查更新，返回值有三种情形："}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"{expired: true}"}),"：该应用原生包已过期（三种情况：1. 主动设置为过期状态，2. 主动删除，3. 从未上传），需要前往应用市场下载新的版本(在设置中填写 downloadUrl)。"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{"data-language":"js","data-theme":"default",children:(0,r.jsxs)(n.code,{"data-language":"js","data-theme":"default",children:[(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"{"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    expired"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"true"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    downloadUrl"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'http://appstore/downloadUrl'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"{upToDate: true}"}),"：当前已经更新到最新，无需进行更新。"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"{update: true}"}),"：当前有新版本可以更新。info 的",(0,r.jsx)(n.code,{children:"name"}),"、",(0,r.jsx)(n.code,{children:"description"}),"字段可以用于提示用户，而",(0,r.jsx)(n.code,{children:"metaInfo"}),"字段则可以根据你的需求自定义一些标记(如是否静默更新、是否强制更新等等，自己根据标记的属性做一些条件流程控制)，具体用法可参考",(0,r.jsx)(n.a,{href:"bestpractice#%E5%85%83%E4%BF%A1%E6%81%AFmeta-info%E7%9A%84%E4%BD%BF%E7%94%A8",children:"场景实践"}),"。另外还有几个字段，包含了热更新文件的下载地址，"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{"data-language":"js","data-theme":"default",children:(0,r.jsxs)(n.code,{"data-language":"js","data-theme":"default",children:[(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"{"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    update"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"true"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    name"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'1.0.3-rc'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    hash"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'hash'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    description"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'添加聊天功能\\n修复商城页面BUG'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    metaInfo"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'{\"silent\":true}'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    pdiffUrl"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'http://update-packages.reactnative.cn/hash'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    diffUrl"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'http://update-packages.reactnative.cn/hash'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"async-function-downloadupdate",children:"async function downloadUpdate()"}),"\n",(0,r.jsxs)(n.p,{children:["下载热更包。仅当",(0,r.jsx)(n.code,{children:"update:true"}),"时实际进行下载。会更新",(0,r.jsx)(n.code,{children:"progress"}),"数据。"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"function-downloadandinstallapkurl",children:"function downloadAndInstallApk(url)"}),"\n",(0,r.jsxs)(n.p,{children:["下载更新的 apk 包并直接安装。",(0,r.jsx)(n.code,{children:"url"}),"必须为可直接下载到 apk 文件的地址。"]}),"\n",(0,r.jsxs)(n.p,{children:["注意要使用这个功能还需要在",(0,r.jsx)(n.code,{children:"AndroidManifest.xml"}),"中手动添加安装权限，如果需要考虑 Android 7.0 以下的客户，则还需要添加外部存储权限。"]}),"\n",(0,r.jsx)(n.pre,{"data-language":"xml","data-theme":"default",children:(0,r.jsxs)(n.code,{"data-language":"xml","data-theme":"default",children:[(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"<"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"uses-permission"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"android"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"name"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"android.permission.REQUEST_INSTALL_PACKAGES"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" />"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:" "}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"<!-- 如果需要考虑Android 7.0以下的客户，则还需要添加外部存储权限 -->"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"<"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"uses-permission"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"android"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"name"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"android.permission.WRITE_EXTERNAL_STORAGE"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" />"})]})]})}),"\n",(0,r.jsx)(n.p,{children:"注意某些应用市场可能会因为上述权限拒绝应用上架。去掉上述两个权限并不影响热更新功能。"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"function-marksuccess",children:"function markSuccess()"}),"\n",(0,r.jsxs)(n.p,{children:["在",(0,r.jsx)(n.code,{children:"isFirstTime"}),"为",(0,r.jsx)(n.code,{children:"true"}),"时，必须调用此函数作为更新成功的标记（否则下次启动会默认失败自动回滚）。"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"async-function-getcurrentversioninfo",children:"async function getCurrentVersionInfo()"}),"\n",(0,r.jsx)(n.p,{children:"获取当前已热更版本的信息（如尚未热更过则返回空对象）。"}),"\n",(0,r.jsx)(n.p,{children:"返回值示例："}),"\n",(0,r.jsx)(n.pre,{"data-language":"js","data-theme":"default",children:(0,r.jsxs)(n.code,{"data-language":"js","data-theme":"default",children:[(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"{"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    name"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'1.0.3-rc'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    description"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'添加聊天功能\\n修复商城页面BUG'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    metaInfo"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'{\"silent\":true}'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"function-switchversion",children:"function switchVersion()"}),"\n",(0,r.jsx)(n.p,{children:"立即重启应用，并加载已经下载完毕的版本。"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"function-switchversionlater",children:"function switchVersionLater()"}),"\n",(0,r.jsx)(n.p,{children:"在下一次启动应用的时候加载已经下载完毕的版本。"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"function-onpushyevents-type-eventtype-data-eventdata---void",children:"function onPushyEvents(({ type: EventType; data: EventData }) => void)"}),"\n",(0,r.jsxs)(n.p,{children:["发生某个事件时的回调，可用于上报统计数据。自",(0,r.jsx)(n.code,{children:"v8.4.0"}),"版本后可用。其中回调参数构型具体如下："]}),"\n",(0,r.jsx)(n.pre,{"data-language":"ts","data-theme":"default",children:(0,r.jsxs)(n.code,{"data-language":"ts","data-theme":"default",children:[(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 回调事件类型"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"type"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"EventType"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"rollback"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 回滚"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"errorChecking"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 查询热更时出错"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"checking"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 正在查询热更"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"downloading"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 正在下载热更"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"errorUpdate"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 热更时出错"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"markSuccess"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 热更后成功标记"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"downloadingApk"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 正在下载apk"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"rejectStoragePermission"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 下载apk前申请存储权限被用户拒绝"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"errorStoragePermission"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 下载apk前申请存储权限出错"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"errowDownloadAndInstallApk"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"; "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 下载或安装apk时出错"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:" "}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 回调事件数据"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"interface"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"EventData"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  currentVersion"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"string"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"; "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 当前版本hash"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  cInfo"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    pushy"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"string"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"; "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 当前pushy版本"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    rn"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"string"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"; "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 当前rn版本"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    os"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"string"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"; "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 当前操作系统及版本"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    uuid"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"string"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"; "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 用户标识符"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  };"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  packageVersion"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"string"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"; "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 原生包版本"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  buildTime"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"number"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"; "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 原生包编译时间戳"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  message"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"string"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"; "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 相关说明信息"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  rolledBackVersion"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"string"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"; "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 热更失败，回滚后的版本hash"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  newVersion"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"string"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"; "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 已下载但热更失败的hash"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"android-方法",children:"Android 方法"}),"\n",(0,r.jsx)(n.h4,{id:"updatecontextsetcustominstancemanagerreactinstancemanager-instancemanager",children:"UpdateContext.setCustomInstanceManager(ReactInstanceManager instanceManager)"}),"\n",(0,r.jsxs)(n.p,{children:["如果是集成/混编 Android 方案，则可以使用此方法传入你自行创建的 ReactInstanceManager。自",(0,r.jsx)(n.code,{children:"v5.5.8"}),"版本起可用。"]}),"\n",(0,r.jsx)(n.p,{children:"示例："}),"\n",(0,r.jsx)(n.pre,{"data-language":"java","data-theme":"default",children:(0,r.jsxs)(n.code,{"data-language":"java","data-theme":"default",children:[(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"cn"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"reactnative"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"modules"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"update"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"UpdateContext"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:" "}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"mReactInstanceManager = ReactInstanceManager"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"builder()"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"                "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// ...各种setter，但注意不要调用setBundleAssetName"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"                "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"setJSBundleFile(UpdateContext"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'getBundleUrl(mContext, "assets:'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:'//index.android.bundle"))'})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"                "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"build()"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"UpdateContext"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"setCustomInstanceManager"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"(mReactInstanceManager);"})]})]})})]})}n.default=(0,i.j)({MDXContent:function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,l.a)(),s.components);return n?(0,r.jsx)(n,{...s,children:(0,r.jsx)(t,{...s})}):t(s)},pageOpts:{filePath:"pages/docs/api.md",route:"/docs/api",frontMatter:{order:11,title:"API参考",type:"开发指南"},title:"API参考",headings:o},pageNextRoute:"/docs/api"})}},function(s){s.O(0,[567,888,774,179],function(){return s(s.s=16237)}),_N_E=s.O()}]);