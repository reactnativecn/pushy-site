{"componentChunkName":"component---src-templates-docs-tsx","path":"/docs/publish.html","result":{"data":{"markdownRemark":{"html":"<p>现在你的应用已经具备了检测更新的功能，下面我们来尝试发布并更新它。</p>\n<blockquote>\n<p><strong>注意</strong>，从update上传发布版本到发布版本正式上线期间，不要修改任何脚本和资源，这会影响update\n获取本地代码，从而导致版本不能更新。如果在发布之前修改了脚本或资源，请在网页端删除之前上传的版本并重新上传。</p>\n</blockquote>\n<h2 id=\"发布ios应用\" style=\"position:relative;\"><a href=\"#%E5%8F%91%E5%B8%83ios%E5%BA%94%E7%94%A8\" aria-label=\"发布ios应用 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>发布iOS应用</h2>\n<p>首先参考<a href=\"https://reactnative.cn/docs/running-on-device-ios.html#content\">文档-在设备上运行</a>，\n确定你正在使用离线包。然后点击菜单。</p>\n<p>按照正常的发布流程打包<code>.ipa</code>文件(Xcode中运行设备选真机或Generic iOS Device，然后菜单中选择Product-Archive)，然后运行如下命令</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ pushy uploadIpa <span class=\"token operator\">&lt;</span>your-package.ipa<span class=\"token operator\">></span></code></pre></div>\n<p>即可上传ipa以供后续版本比对之用。此ipa的<code>CFBundleShortVersionString</code>字段(位于<code>ios/项目名/Info.plist</code>中)会被记录为原生版本号<code>packageVersion</code>。</p>\n<p>随后你可以选择往AppStore发布这个版本，也可以先通过Test flight等方法进行测试。</p>\n<h2 id=\"发布安卓应用\" style=\"position:relative;\"><a href=\"#%E5%8F%91%E5%B8%83%E5%AE%89%E5%8D%93%E5%BA%94%E7%94%A8\" aria-label=\"发布安卓应用 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>发布安卓应用</h2>\n<p>首先参考<a href=\"https://reactnative.cn/docs/signed-apk-android.html#content\">文档-生成已签名的APK</a>设置签名，\n然后在android文件夹下运行<code>./gradlew assembleRelease</code>或<code>./gradlew aR</code>，你就可以在<code>android/app/build/outputs/apk/release/app-release.apk</code>中找到你的应用包。</p>\n<p>然后运行如下命令</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ pushy uploadApk android/app/build/outputs/apk/release/app-release.apk</code></pre></div>\n<p>即可上传apk以供后续版本比对之用。此apk的<code>versionName</code>字段(位于<code>android/build.gralde</code>中)会被记录为原生版本号<code>packageVersion</code>。</p>\n<p>随后你可以选择往应用市场发布这个版本，也可以先往设备上直接安装这个apk文件以进行测试。</p>\n<h2 id=\"发布新的热更新版本\" style=\"position:relative;\"><a href=\"#%E5%8F%91%E5%B8%83%E6%96%B0%E7%9A%84%E7%83%AD%E6%9B%B4%E6%96%B0%E7%89%88%E6%9C%AC\" aria-label=\"发布新的热更新版本 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>发布新的热更新版本</h2>\n<p>你可以尝试修改一行代码(譬如将版本一修改为版本二)，然后生成新的热更新版本。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ pushy bundle --platform <span class=\"token operator\">&lt;</span>ios<span class=\"token operator\">|</span>android<span class=\"token operator\">></span>\nBundling with React Native version:  <span class=\"token number\">0.22</span>.2\n<span class=\"token operator\">&lt;</span>各种进度输出<span class=\"token operator\">></span>\nBundled saved to: build/output/android.1459850548545.ppk\nWould you like to publish it?<span class=\"token punctuation\">(</span>Y/N<span class=\"token punctuation\">)</span> </code></pre></div>\n<p>如果想要立即发布，此时输入Y。当然，你也可以在将来使用<code>pushy publish --platform &#x3C;ios|android> &#x3C;ppkFile></code>来发布版本。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">  Uploading [========================================================] 100% 0.0s\nEnter version name: &lt;输入热更新版本名字，如1.0.0-rc&gt;\nEnter description: &lt;输入热更新版本描述&gt;\nEnter meta info: {&quot;ok&quot;:1}\nOk.\nWould you like to bind packages to this version?(Y/N)</code></pre></div>\n<p>此时版本已经提交到update服务，但用户暂时看不到此更新，你需要先将特定的原生包版本绑定到此热更新版本上。</p>\n<p>此时输入Y立即绑定，你也可以在将来使用<code>pushy update --platform &#x3C;ios|android></code>来使得对应原生包版本的用户更新。\n除此以外，你还可以在网页端操作，简单的将对应的原生包版本拖到此热更新版本下即可。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Offset 0\n1) FvXnROJ1 1.0.1 (no package)\n2) FiWYm9lB 1.0 [1.0]\nEnter versionId or page Up/page Down/Begin(U/D/B) &lt;输入序号,U/D翻页,B回到开始，序号就是上面列表中)前面的数字&gt;\n\n1) 1.0(normal) - 3 FiWYm9lB (未命名)\n\nTotal 1 packages.\nEnter packageId: &lt;输入原生包版本序号，序号就是上面列表中)前面的数字&gt;</code></pre></div>\n<p>版本绑定完毕后，客户端就应当可以检查到更新并进行更新了。</p>\n<p>恭喜你，至此为止，你已经完成了植入代码热更新的全部工作。接下来，你可以查阅<a href=\"faq_advance.md\">常见问题与高级指南</a>了解更多深入的知识，尤其是在实际项目中的运用技巧。</p>","tableOfContents":"<ul>\n<li><a href=\"/docs/publish/#%E5%8F%91%E5%B8%83ios%E5%BA%94%E7%94%A8\">发布iOS应用</a></li>\n<li><a href=\"/docs/publish/#%E5%8F%91%E5%B8%83%E5%AE%89%E5%8D%93%E5%BA%94%E7%94%A8\">发布安卓应用</a></li>\n<li><a href=\"/docs/publish/#%E5%8F%91%E5%B8%83%E6%96%B0%E7%9A%84%E7%83%AD%E6%9B%B4%E6%96%B0%E7%89%88%E6%9C%AC\">发布新的热更新版本</a></li>\n</ul>","frontmatter":{"title":"发布热更新","order":2,"type":"快速入门"},"fields":{"path":"/docs/publish.md","slug":"/docs/publish","modifiedTime":1590335754037}},"allMarkdownRemark":{"edges":[{"node":{"frontmatter":{"title":"常见问题","order":23,"type":"其他"},"fields":{"slug":"/docs/faq","path":"/docs/faq.md"}}},{"node":{"frontmatter":{"title":"更新日志","order":22,"type":"其他"},"fields":{"slug":"/docs/changelog","path":"/docs/changelog.md"}}},{"node":{"frontmatter":{"title":"场景实践","order":13,"type":"开发指南"},"fields":{"slug":"/docs/bestpractice","path":"/docs/bestpractice.md"}}},{"node":{"frontmatter":{"title":"命令行工具","order":12,"type":"开发指南"},"fields":{"slug":"/docs/cli","path":"/docs/cli.md"}}},{"node":{"frontmatter":{"title":"API参考","order":11,"type":"开发指南"},"fields":{"slug":"/docs/api","path":"/docs/api.md"}}},{"node":{"frontmatter":{"title":"工作流程","order":10,"type":"开发指南"},"fields":{"slug":"/docs/workflow","path":"/docs/workflow.md"}}},{"node":{"frontmatter":{"title":"发布热更新","order":2,"type":"快速入门"},"fields":{"slug":"/docs/publish","path":"/docs/publish.md"}}},{"node":{"frontmatter":{"title":"代码集成","order":1,"type":"快速入门"},"fields":{"slug":"/docs/integration","path":"/docs/integration.md"}}},{"node":{"frontmatter":{"title":"安装配置","order":0,"type":"快速入门"},"fields":{"slug":"/docs/getting-started","path":"/docs/getting-started.md"}}}]}},"pageContext":{"slug":"/docs/publish","type":"/docs/"}}}