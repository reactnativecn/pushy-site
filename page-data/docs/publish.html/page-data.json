{"componentChunkName":"component---src-templates-docs-tsx","path":"/docs/publish.html","result":{"data":{"markdownRemark":{"html":"<p>现在你的应用已经具备了检测更新的功能，下面我们来尝试发布并更新它。流程可参考下图：</p>\n<div class=\"mermaid\" data-processed=\"true\"><svg id=\"mermaid-1611913033640\" width=\"100%\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" height=\"577\" style=\"max-width: 498.125px;\" viewBox=\"0 0 498.125 577\"><style>#mermaid-1611913033640{font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1611913033640 .error-icon{fill:#552222;}#mermaid-1611913033640 .error-text{fill:#552222;stroke:#552222;}#mermaid-1611913033640 .edge-thickness-normal{stroke-width:2px;}#mermaid-1611913033640 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1611913033640 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1611913033640 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1611913033640 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1611913033640 .marker{fill:#333333;}#mermaid-1611913033640 .marker.cross{stroke:#333333;}#mermaid-1611913033640 svg{font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;}#mermaid-1611913033640 .label{font-family:\"trebuchet ms\",verdana,arial,sans-serif;color:#333;}#mermaid-1611913033640 .label text{fill:#333;}#mermaid-1611913033640 .node rect,#mermaid-1611913033640 .node circle,#mermaid-1611913033640 .node ellipse,#mermaid-1611913033640 .node polygon,#mermaid-1611913033640 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1611913033640 .node .label{text-align:center;}#mermaid-1611913033640 .node.clickable{cursor:pointer;}#mermaid-1611913033640 .arrowheadPath{fill:#333333;}#mermaid-1611913033640 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaid-1611913033640 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1611913033640 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1611913033640 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1611913033640 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1611913033640 .cluster text{fill:#333;}#mermaid-1611913033640 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1611913033640:root{--mermaid-font-family:\"trebuchet ms\",verdana,arial,sans-serif;}#mermaid-1611913033640 flowchart-v2{fill:apa;}</style><g transform=\"translate(0, 0)\"><marker id=\"flowchart-pointEnd\" class=\"marker flowchart\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerUnits=\"userSpaceOnUse\" markerWidth=\"12\" markerHeight=\"12\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowMarkerPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker><marker id=\"flowchart-pointStart\" class=\"marker flowchart\" viewBox=\"0 0 10 10\" refX=\"0\" refY=\"5\" markerUnits=\"userSpaceOnUse\" markerWidth=\"12\" markerHeight=\"12\" orient=\"auto\"><path d=\"M 0 5 L 10 10 L 10 0 z\" class=\"arrowMarkerPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker><marker id=\"flowchart-circleEnd\" class=\"marker flowchart\" viewBox=\"0 0 10 10\" refX=\"11\" refY=\"5\" markerUnits=\"userSpaceOnUse\" markerWidth=\"11\" markerHeight=\"11\" orient=\"auto\"><circle cx=\"5\" cy=\"5\" r=\"5\" class=\"arrowMarkerPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></circle></marker><marker id=\"flowchart-circleStart\" class=\"marker flowchart\" viewBox=\"0 0 10 10\" refX=\"-1\" refY=\"5\" markerUnits=\"userSpaceOnUse\" markerWidth=\"11\" markerHeight=\"11\" orient=\"auto\"><circle cx=\"5\" cy=\"5\" r=\"5\" class=\"arrowMarkerPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></circle></marker><marker id=\"flowchart-crossEnd\" class=\"marker cross flowchart\" viewBox=\"0 0 11 11\" refX=\"12\" refY=\"5.2\" markerUnits=\"userSpaceOnUse\" markerWidth=\"11\" markerHeight=\"11\" orient=\"auto\"><path d=\"M 1,1 l 9,9 M 10,1 l -9,9\" class=\"arrowMarkerPath\" style=\"stroke-width: 2; stroke-dasharray: 1, 0;\"></path></marker><marker id=\"flowchart-crossStart\" class=\"marker cross flowchart\" viewBox=\"0 0 11 11\" refX=\"-1\" refY=\"5.2\" markerUnits=\"userSpaceOnUse\" markerWidth=\"11\" markerHeight=\"11\" orient=\"auto\"><path d=\"M 1,1 l 9,9 M 10,1 l -9,9\" class=\"arrowMarkerPath\" style=\"stroke-width: 2; stroke-dasharray: 1, 0;\"></path></marker><g class=\"root\"><g class=\"clusters\"></g><g class=\"edgePaths\"><path d=\"M208.8671875,39.78875968992248L191.60807291666666,48.740633074935396C174.34895833333334,57.69250645994831,139.83072916666666,75.59625322997415,122.57161458333333,93.38145994832041C105.3125,111.16666666666667,105.3125,128.83333333333334,105.3125,137.66666666666666L105.3125,146.5\" id=\"L-codebase-发布热更新版本\" class=\" edge-thickness-normal edge-pattern-solid flowchart-link LS-codebase LE-发布热更新版本\" style=\"fill:none;\" marker-end=\"url(#flowchart-pointEnd)\"></path><path d=\"M267.8203125,39.78875968992248L285.0794270833333,48.740633074935396C302.3385416666667,57.69250645994831,336.8567708333333,75.59625322997415,354.1158854166667,93.29812661498708C371.375,111,371.375,128.5,371.375,137.25L371.375,146\" id=\"L-codebase-发布原生基准版本\" class=\" edge-thickness-normal edge-pattern-solid flowchart-link LS-codebase LE-发布原生基准版本\" style=\"fill:none;\" marker-end=\"url(#flowchart-pointEnd)\"></path><path d=\"M105.3125,467.5L105.3125,473.25C105.3125,479,105.3125,490.5,105.3125,501.9166666666667C105.3125,513.3333333333334,105.3125,524.6666666666666,105.3125,530.3333333333334L105.3125,536\" id=\"L-发布热更新版本-user\" class=\" edge-thickness-normal edge-pattern-solid flowchart-link LS-发布热更新版本 LE-user\" style=\"fill:none;\" marker-end=\"url(#flowchart-pointEnd)\"></path></g><g class=\"edgeLabels\"><g class=\"edgeLabel\" transform=\"translate(105.3125, 93.5)\"><g class=\"label\" transform=\"translate(-55.453125, -27.5)\"><foreignObject width=\"110.90625\" height=\"55\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"edgeLabel\">✏️&nbsp;&nbsp;改动js代码，<br>或添加、更新js组件，<br>或添加、更新js代码中引用的图片等资源</span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"translate(371.375, 93.5)\"><g class=\"label\" transform=\"translate(-55.515625, -27)\"><foreignObject width=\"111.03125\" height=\"54\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"edgeLabel\">🖊️&nbsp;&nbsp;改动原生代码、设置，<br>或添加、更新原生组件，<br>或添加、更新原生代码中引用的图片等资源</span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"translate(105.3125, 502)\"><g class=\"label\" transform=\"translate(-49.5234375, -9)\"><foreignObject width=\"99.046875\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"edgeLabel\">📲&nbsp;&nbsp;推送增量热更新(diff文件)</span></div></foreignObject></g></g></g><g class=\"nodes\"><g class=\"root\" transform=\"translate(0, 138.5)\"><g class=\"clusters\"><g class=\"cluster default\" id=\"发布热更新版本\"><rect style=\"\" rx=\"0\" ry=\"0\" x=\"8\" y=\"8\" width=\"194.625\" height=\"321\"></rect><g class=\"cluster-label\" transform=\"translate(84.859375, 13)\"><foreignObject width=\"40.90625\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"nodeLabel\">发布热更新版本</span></div></foreignObject></g></g></g><g class=\"edgePaths\"><path d=\"M105.3125,66L105.3125,74.66666666666667C105.3125,83.33333333333333,105.3125,100.66666666666667,105.3125,118C105.3125,135.33333333333334,105.3125,152.66666666666666,105.3125,161.33333333333334L105.3125,170\" id=\"L-tagBundleVersion-bundlePackage\" class=\" edge-thickness-normal edge-pattern-solid flowchart-link LS-tagBundleVersion LE-bundlePackage\" style=\"fill:none;\" marker-end=\"url(#flowchart-pointEnd)\"></path><path d=\"M105.3125,203L105.3125,208.66666666666666C105.3125,214.33333333333334,105.3125,225.66666666666666,105.3125,237C105.3125,248.33333333333334,105.3125,259.6666666666667,105.3125,265.3333333333333L105.3125,271\" id=\"L-bundlePackage-someNativeVersions\" class=\" edge-thickness-normal edge-pattern-solid flowchart-link LS-bundlePackage LE-someNativeVersions\" style=\"fill:none;\" marker-end=\"url(#flowchart-pointEnd)\"></path></g><g class=\"edgeLabels\"><g class=\"edgeLabel\" transform=\"translate(105.3125, 118)\"><g class=\"label\" transform=\"translate(-47.59375, -27)\"><foreignObject width=\"95.1875\" height=\"54\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"edgeLabel\">🔨&nbsp;&nbsp;使用<br>pushy bundle<br>命令生成并上传</span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"translate(105.3125, 237)\"><g class=\"label\" transform=\"translate(-13.2109375, -9)\"><foreignObject width=\"26.421875\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"edgeLabel\">🖇️&nbsp;&nbsp;绑定</span></div></foreignObject></g></g></g><g class=\"nodes\"><g class=\"node default default\" id=\"flowchart-tagBundleVersion-30\" transform=\"translate(105.3125, 49.5)\"><rect class=\"basic label-container\" style=\"\" rx=\"0\" ry=\"0\" x=\"-62.3125\" y=\"-16.5\" width=\"124.625\" height=\"33\"></rect><g class=\"label\" style=\"\" transform=\"translate(-54.8125, -9)\"><foreignObject width=\"109.625\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"nodeLabel\">🏷️&nbsp;&nbsp;(在 git 上)标记热更新版本号</span></div></foreignObject></g></g><g class=\"node default default\" id=\"flowchart-bundlePackage-31\" transform=\"translate(105.3125, 186.5)\"><rect class=\"basic label-container\" style=\"\" rx=\"0\" ry=\"0\" x=\"-62.25\" y=\"-16.5\" width=\"124.5\" height=\"33\"></rect><g class=\"label\" style=\"\" transform=\"translate(-54.75, -9)\"><foreignObject width=\"109.5\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"nodeLabel\">🎁&nbsp;&nbsp;js代码与资源包(ppk文件)</span></div></foreignObject></g></g><g class=\"node default default\" id=\"flowchart-someNativeVersions-34\" transform=\"translate(105.3125, 287.5)\"><rect class=\"basic label-container\" style=\"\" rx=\"0\" ry=\"0\" x=\"-47.0078125\" y=\"-16.5\" width=\"94.015625\" height=\"33\"></rect><g class=\"label\" style=\"\" transform=\"translate(-39.5078125, -9)\"><foreignObject width=\"79.015625\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"nodeLabel\">🗂️&nbsp;&nbsp;一个或多个原生基准版本</span></div></foreignObject></g></g></g></g><g class=\"root\" transform=\"translate(244.625, 138)\"><g class=\"clusters\"><g class=\"cluster default\" id=\"发布原生基准版本\"><rect style=\"\" rx=\"0\" ry=\"0\" x=\"8\" y=\"8\" width=\"237.5\" height=\"322\"></rect><g class=\"cluster-label\" transform=\"translate(103.375, 13)\"><foreignObject width=\"46.75\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"nodeLabel\">发布原生基准版本</span></div></foreignObject></g></g></g><g class=\"edgePaths\"><path d=\"M126.75,66L126.75,71.66666666666667C126.75,77.33333333333333,126.75,88.66666666666667,126.75,100C126.75,111.33333333333333,126.75,122.66666666666667,126.75,128.33333333333334L126.75,134\" id=\"L-tagNativeVersion-nativePackage\" class=\" edge-thickness-normal edge-pattern-solid flowchart-link LS-tagNativeVersion LE-nativePackage\" style=\"fill:none;\" marker-end=\"url(#flowchart-pointEnd)\"></path><path d=\"M126.75,167L126.75,175.75C126.75,184.5,126.75,202,126.75,219.5C126.75,237,126.75,254.5,126.75,263.25L126.75,272\" id=\"L-nativePackage-newNativeVersion\" class=\" edge-thickness-normal edge-pattern-solid flowchart-link LS-nativePackage LE-newNativeVersion\" style=\"fill:none;\" marker-end=\"url(#flowchart-pointEnd)\"></path></g><g class=\"edgeLabels\"><g class=\"edgeLabel\" transform=\"translate(126.75, 100)\"><g class=\"label\" transform=\"translate(-13.2109375, -9)\"><foreignObject width=\"26.421875\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"edgeLabel\">🔨&nbsp;&nbsp;编译</span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"translate(126.75, 219.5)\"><g class=\"label\" transform=\"translate(-98.75, -27.5)\"><foreignObject width=\"197.5\" height=\"55\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"edgeLabel\">⬆️&nbsp;&nbsp;使用<br>pushy uploadApk/uploadIpa<br>命令上传</span></div></foreignObject></g></g></g><g class=\"nodes\"><g class=\"node default default\" id=\"flowchart-tagNativeVersion-23\" transform=\"translate(126.75, 49.5)\"><rect class=\"basic label-container\" style=\"\" rx=\"0\" ry=\"0\" x=\"-59.390625\" y=\"-16.5\" width=\"118.78125\" height=\"33\"></rect><g class=\"label\" style=\"\" transform=\"translate(-51.890625, -9)\"><foreignObject width=\"103.78125\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"nodeLabel\">🏷️&nbsp;&nbsp;(在 git 上)标记原生版本号</span></div></foreignObject></g></g><g class=\"node default default\" id=\"flowchart-nativePackage-25\" transform=\"translate(126.75, 150.5)\"><rect class=\"basic label-container\" style=\"\" rx=\"0\" ry=\"0\" x=\"-67.1484375\" y=\"-16.5\" width=\"134.296875\" height=\"33\"></rect><g class=\"label\" style=\"\" transform=\"translate(-59.6484375, -9)\"><foreignObject width=\"119.296875\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"nodeLabel\">📦&nbsp;&nbsp;原生完整包(apk或ipa文件)</span></div></foreignObject></g></g><g class=\"node default default\" id=\"flowchart-newNativeVersion-24\" transform=\"translate(126.75, 288.5)\"><rect class=\"basic label-container\" style=\"\" rx=\"0\" ry=\"0\" x=\"-38.2421875\" y=\"-16.5\" width=\"76.484375\" height=\"33\"></rect><g class=\"label\" style=\"\" transform=\"translate(-30.7421875, -9)\"><foreignObject width=\"61.484375\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"nodeLabel\">🗂️&nbsp;&nbsp;新的原生基准版本</span></div></foreignObject></g></g></g></g><g class=\"node default default\" id=\"flowchart-codebase-22\" transform=\"translate(238.34375, 24.5)\"><rect class=\"basic label-container\" style=\"\" rx=\"0\" ry=\"0\" x=\"-29.4765625\" y=\"-16.5\" width=\"58.953125\" height=\"33\"></rect><g class=\"label\" style=\"\" transform=\"translate(-21.9765625, -9)\"><foreignObject width=\"43.953125\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"nodeLabel\">🖥️&nbsp;&nbsp;项目代码库</span></div></foreignObject></g></g><g class=\"node default default\" id=\"flowchart-user-37\" transform=\"translate(105.3125, 552.5)\"><rect class=\"basic label-container\" style=\"\" rx=\"0\" ry=\"0\" x=\"-64.5390625\" y=\"-16.5\" width=\"129.078125\" height=\"33\"></rect><g class=\"label\" style=\"\" transform=\"translate(-57.0390625, -9)\"><foreignObject width=\"114.078125\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"nodeLabel\">👨‍👩‍👧‍👦&nbsp;&nbsp;安装有对应原生基准版本的用户</span></div></foreignObject></g></g></g></g></g></svg></div>\n<p>一般来说我们需要先发布原生基准版本，然后在基准版本之上迭代业务逻辑，发布热更新版本。如果迭代过程中有原生方面的修改，则需要发布新的基准版本。可以只保留一个原生基准版本，也可以多版本同时维护。</p>\n<h2 id=\"发布原生基准版本\" style=\"position:relative;\"><a href=\"#%E5%8F%91%E5%B8%83%E5%8E%9F%E7%94%9F%E5%9F%BA%E5%87%86%E7%89%88%E6%9C%AC\" aria-label=\"发布原生基准版本 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>发布原生基准版本</h2>\n<h3 id=\"ios\" style=\"position:relative;\"><a href=\"#ios\" aria-label=\"ios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>iOS</h3>\n<p>首先参考<a href=\"https://reactnative.cn/docs/running-on-device\">文档-在设备上运行</a>，确定你正在使用离线包。然后点击菜单。</p>\n<p>按照正常的发布流程打包<code>.ipa</code>文件：</p>\n<ol>\n<li>Xcode 中运行设备选真机或 Generic iOS Device</li>\n<li>菜单中选择 Product - Archive</li>\n<li>Archive 完成后选择<code>Export</code>生成.ipa 文件，此时建议取消 bitcode 选项以减少 ipa 大小</li>\n<li>然后运行如下命令上传到 pushy 服务器以供后续版本比对之用</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ pushy uploadIpa <span class=\"token operator\">&lt;</span>your-package.ipa<span class=\"token operator\">></span></code></pre></div>\n<p>此 ipa 的<code>CFBundleShortVersionString</code>字段(位于<code>ios/项目名/Info.plist</code>中)会被记录为原生版本号<code>packageVersion</code>。</p>\n<p>随后你可以选择往 AppStore 上传这个版本（注意是刚刚已经 archive 完成的包重新选择 Upload 选项，且此时应该勾选 bitcode 选项），也可以先通过<a href=\"https://developer.apple.com/cn/testflight/\">Test flight</a>或<a href=\"https://www.pgyer.com/doc/view/build_ipa\">蒲公英</a>等渠道进行真机安装测试。请注意：暂不支持通过 Xcode 直接进行热更新测试。</p>\n<p>如果后续需要再次打包（例如修改原生代码或配置），请先<strong>更改版本号</strong>，并再次<code>uploadIpa</code>到服务器端记录，否则后续生成的相同版本的原生包会由于<a href=\"faq.html#%E7%83%AD%E6%9B%B4%E6%96%B0%E6%8A%A5%E9%94%99%EF%BC%9A%E7%83%AD%E6%9B%B4%E6%96%B0%E5%B7%B2%E6%9A%82%E5%81%9C%EF%BC%8C%E5%8E%9F%E5%9B%A0%EF%BC%9Abuildtime-mismatch%E3%80%82\">编译时间戳不一致而<code>无法获取热更新</code></a>。</p>\n<blockquote>\n<p>注意：如果你在上传之前就运行了新的原生版本，由于服务器端没有记录，会暂停其更新数小时。可在删除原先安装的 app 再重新安装以清空暂停设置。在上传之后安装的客户端不会受此影响。</p>\n</blockquote>\n<h3 id=\"android\" style=\"position:relative;\"><a href=\"#android\" aria-label=\"android permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Android</h3>\n<p>首先参考<a href=\"https://reactnative.cn/docs/signed-apk-android\">文档-打包 APK</a>设置签名，然后在 android 文件夹下运行<code>./gradlew assembleRelease</code>或<code>./gradlew aR</code>，你就可以在<code>android/app/build/outputs/apk/release/app-release.apk</code>中找到你的应用包。</p>\n<p>然后运行如下命令</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ pushy uploadApk android/app/build/outputs/apk/release/app-release.apk</code></pre></div>\n<p>即可上传 apk 以供后续版本比对之用。此 apk 的<code>versionName</code>字段(位于<code>android/build.gralde</code>中)会被记录为原生版本号<code>packageVersion</code>。</p>\n<p>随后你可以选择往应用市场发布这个版本，也可以先往设备上直接安装这个 apk 文件以进行测试。</p>\n<p>如果后续需要再次打包（例如修改原生代码或配置），请先<strong>更改版本号</strong>，并再次<code>uploadApk</code>到服务器端记录，否则后续生成的相同版本的原生包会由于<a href=\"faq.html#%E7%83%AD%E6%9B%B4%E6%96%B0%E6%8A%A5%E9%94%99%EF%BC%9A%E7%83%AD%E6%9B%B4%E6%96%B0%E5%B7%B2%E6%9A%82%E5%81%9C%EF%BC%8C%E5%8E%9F%E5%9B%A0%EF%BC%9Abuildtime-mismatch%E3%80%82\">编译时间戳不一致而<code>无法获取热更新</code></a>。</p>\n<blockquote>\n<p>注意：如果你在上传之前就运行了新的原生版本，由于服务器端没有记录，会暂停其更新数小时。可删除原先安装的 app 再重新安装以清空暂停设置。在上传之后安装的客户端不会受此影响。</p>\n</blockquote>\n<h2 id=\"发布热更新版本\" style=\"position:relative;\"><a href=\"#%E5%8F%91%E5%B8%83%E7%83%AD%E6%9B%B4%E6%96%B0%E7%89%88%E6%9C%AC\" aria-label=\"发布热更新版本 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>发布热更新版本</h2>\n<p>你可以尝试修改一行代码(譬如将版本一修改为版本二)，然后生成新的热更新版本。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ pushy bundle --platform <span class=\"token operator\">&lt;</span>ios<span class=\"token operator\">|</span>android<span class=\"token operator\">></span>\nBundling with React Native version:  <span class=\"token number\">0.22</span>.2\n<span class=\"token operator\">&lt;</span>各种进度输出<span class=\"token operator\">></span>\nBundled saved to: build/output/android.1459850548545.ppk\nWould you like to publish it?<span class=\"token punctuation\">(</span>Y/N<span class=\"token punctuation\">)</span></code></pre></div>\n<p>如果想要立即发布，此时输入 Y。当然，你也可以在将来使用<code>pushy publish --platform &#x3C;ios|android> &#x3C;ppkFile></code>来发布版本。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">  Uploading [========================================================] 100% 0.0s\nEnter version name: &lt;输入热更新版本名字，如1.0.0-rc&gt;\nEnter description: &lt;输入热更新版本描述&gt;\nEnter meta info: {&quot;ok&quot;:1}\nOk.\nWould you like to bind packages to this version?(Y/N)</code></pre></div>\n<p>此时版本已经提交到 pushy 服务，但用户暂时看不到此更新，你需要先将特定的原生包版本绑定到此热更新版本上。</p>\n<p>此时输入 Y 立即绑定，你也可以在将来使用<code>pushy update --platform &#x3C;ios|android></code>来使得对应原生包版本的用户更新。除此以外，你还可以在网页端操作，简单的将对应的原生包版本拖到此热更新版本下即可。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Offset 0\n1) FvXnROJ1 1.0.1 (no package)\n2) FiWYm9lB 1.0 [1.0]\nEnter versionId or page Up/page Down/Begin(U/D/B) &lt;输入序号,U/D翻页,B回到开始，序号就是上面列表中)前面的数字&gt;\n\n1) 1.0(normal) - 3 FiWYm9lB (未命名)\n\nTotal 1 packages.\nEnter packageId: &lt;输入原生包版本序号，序号就是上面列表中)前面的数字&gt;</code></pre></div>\n<p>版本绑定完毕后，客户端就应当可以检查到更新并进行更新了。</p>\n<p>后续要继续发布新的热更新，只需反复执行<code>pushy bundle</code>命令即可。</p>\n<p>恭喜你，至此为止，你已经完成了植入代码热更新的全部工作。</p>","tableOfContents":"<ul>\n<li>\n<p><a href=\"/docs/publish/#%E5%8F%91%E5%B8%83%E5%8E%9F%E7%94%9F%E5%9F%BA%E5%87%86%E7%89%88%E6%9C%AC\">发布原生基准版本</a></p>\n<ul>\n<li><a href=\"/docs/publish/#ios\">iOS</a></li>\n<li><a href=\"/docs/publish/#android\">Android</a></li>\n</ul>\n</li>\n<li><a href=\"/docs/publish/#%E5%8F%91%E5%B8%83%E7%83%AD%E6%9B%B4%E6%96%B0%E7%89%88%E6%9C%AC\">发布热更新版本</a></li>\n</ul>","frontmatter":{"title":"发布热更新","order":2,"type":"快速入门"},"fields":{"path":"/docs/publish.md","slug":"/docs/publish","modifiedTime":1611912926031}},"allMarkdownRemark":{"edges":[{"node":{"frontmatter":{"title":"常见问题","order":23,"type":"其他"},"fields":{"slug":"/docs/faq","path":"/docs/faq.md"}}},{"node":{"frontmatter":{"title":"更新日志","order":22,"type":"其他"},"fields":{"slug":"/docs/changelog","path":"/docs/changelog.md"}}},{"node":{"frontmatter":{"title":"场景实践","order":13,"type":"开发指南"},"fields":{"slug":"/docs/bestpractice","path":"/docs/bestpractice.md"}}},{"node":{"frontmatter":{"title":"命令行工具","order":12,"type":"开发指南"},"fields":{"slug":"/docs/cli","path":"/docs/cli.md"}}},{"node":{"frontmatter":{"title":"API参考","order":11,"type":"开发指南"},"fields":{"slug":"/docs/api","path":"/docs/api.md"}}},{"node":{"frontmatter":{"title":"发布热更新","order":2,"type":"快速入门"},"fields":{"slug":"/docs/publish","path":"/docs/publish.md"}}},{"node":{"frontmatter":{"title":"代码集成","order":1,"type":"快速入门"},"fields":{"slug":"/docs/integration","path":"/docs/integration.md"}}},{"node":{"frontmatter":{"title":"安装配置","order":0,"type":"快速入门"},"fields":{"slug":"/docs/getting-started","path":"/docs/getting-started.md"}}}]}},"pageContext":{"slug":"/docs/publish","type":"/docs/"}},"staticQueryHashes":[]}